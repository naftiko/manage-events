#	Ruleset name: Spec - JSON Schema - All
#	Ruleset version: 1.1
rules:
  json-schema-2020-12-description-error:
    description: >-
      Each JSON Schema object MUST include a description that explains, in plain
      language, the purpose and function of the object. This description should
      provide a clear overview of how the object is intended to be used within
      operations.
    given: $
    severity: error
    then:
      field: description
      function: truthy
    tags:
      - Discovery
      - Documentation         
  json-schema-2020-12-description-info:
    description: >-
      Each JSON Schema object MUST include a description that explains, in plain
      language, the purpose and function of the object. This description should
      provide a clear overview of how the object is intended to be used within
      operations.
    given: $
    severity: error
    then:
      field: description
      function: falsy
    tags:
      - Discovery
      - Documentation         
  json-schema-2020-12-description-length-error:
    description: >-
      The description for any JSON Schema object should be concise, ensuring it
      remains easy to read and understand for anyone using or interpreting it.
      This approach helps keep the schema self-contained while still providing
      enough context to inform its application wherever it is used.
    given: $
    severity: error
    then:
      field: description
      function: length
      functionOptions:
        max: 250
    tags:
      - Discovery
      - Documentation          
  json-schema-2020-12-description-length-info:
    description: >-
      The description for any JSON Schema object should be concise, ensuring it
      remains easy to read and understand for anyone using or interpreting it.
      This approach helps keep the schema self-contained while still providing
      enough context to inform its application wherever it is used.
    given: $
    severity: info
    then:
      field: description
      function: length
      functionOptions:
        max: 25
    tags:
      - Discovery
      - Documentation          
  json-schema-2020-12-id-error:
    description: >-
      Each JSON Schema object MUST have a unique identifier, represented as a
      URL pointing to its location. The $id property in JSON Schema is used to
      establish the source of truth for any object being defined and validated.
    given: $
    severity: error
    then:
      field: $id
      function: truthy
    tags:
      - Discovery
      - Documentation     
      - Governance   
  json-schema-2020-12-id-info:
    description: >-
      Each JSON Schema object MUST have a unique identifier, represented as a
      URL pointing to its location. The $id property in JSON Schema is used to
      establish the source of truth for any object being defined and validated.
    given: $
    severity: error
    then:
      field: $id
      function: falsy
    tags:
      - Discovery
      - Documentation     
      - Governance       
  json-schema-2020-12-id-source-url-error:
    description: >-
      The $id property in any JSON Schema MUST contain a valid URL pointing to a
      central registry, repository, or another authoritative source for the
      object. This URL ensures that the object's source is always accessible and
      can be used for proper validation.
    given: $
    severity: error
    then:
      field: $id
      function: pattern
      functionOptions:
        match: \b(example.com)\b
    tags:
      - Discovery
      - Documentation     
      - Governance         
  json-schema-2020-12-id-source-url-info:
    description: >-
      The $id property in any JSON Schema MUST contain a valid URL pointing to a
      central registry, repository, or another authoritative source for the
      object. This URL ensures that the object's source is always accessible and
      can be used for proper validation.
    given: $
    severity: error
    then:
      field: $id
      function: pattern
      functionOptions:
        notMatch: \b(example.com)\b
    tags:
      - Discovery
      - Documentation     
      - Governance         
  json-schema-2020-12-properties-allowed-integer-format-error:
    description: >-
      Schema integer properties should have a format property with int32 or
      int64 applied
    message: Type Format MUST Be int32 or int64.
    severity: hint
    given: '$.properties[?(@.type=="integer")]'
    then:
      field: format
      function: enumeration
      functionOptions:
        values:
          - int32
          - int64
    tags:
      - Security
      - Risk   
      - Reliability      
  json-schema-2020-12-properties-allowed-number-format-error:
    description: >-
      Schema integer properties should have a format property with int32 or
      int64 applied
    message: Schema Properties MUST Have Format
    severity: hint
    given: '$.properties[?(@.type=="number")]'
    then:
      field: format
      function: enumeration
      functionOptions:
        values:
          - decimal32
          - decimal64
          - float
          - double
          - decimal128
    tags:
      - Security
      - Risk   
      - Reliability           
  json-schema-2020-12-properties-array-items-error:
    description: >-
      Schema properties that are of the type array must have an items property
      defined
    message: Schema Array Properties MUST Have Items
    severity: error
    given: '$.properties[?(@.type=="array")]'
    then:
      field: items
      function: truthy
    tags:
      - Security
      - Risk    
  json-schema-2020-12-properties-array-items-info:
    description: >-
      Schema properties that are of the type array must have an items property
      defined
    message: Schema Array Properties Has Items
    severity: info
    given: '$.properties[?(@.type=="array")]'
    then:
      field: items
      function: falsy
    tags:
      - Security
      - Risk      
  json-schema-2020-12-properties-array-maxitems-error:
    description: >-
      Schema properties that are of the type array should have a max items
      property defined
    message: Schema Array Properties MUST Have Max Items
    severity: error
    given: '$.properties[?(@.type=="array")]'
    then:
      - field: maxItems
        function: truthy
    tags:
      - Security
      - Risk  
  json-schema-2020-12-properties-array-maxitems-info:
    description: >-
      Schema properties that are of the type array should have a max items
      property defined
    message: Schema Array Properties Have Max Items
    severity: info
    given: '$.properties[?(@.type=="array")]'
    then:
      - field: maxItems
        function: truthy
    tags:
      - Security
      - Risk          
  json-schema-2020-12-properties-array-minitems-error:
    description: >-
      Schema properties that are of the type array should have a min items
      property defined
    message: Schema Array Properties MUST Have Min Items
    severity: error
    given: '$.properties[?(@.type=="array")]'
    then:
      - field: minItems
        function: truthy
    tags:
      - Security
      - Risk          
  json-schema-2020-12-properties-array-minitems-info:
    description: >-
      Schema properties that are of the type array should have a min items
      property defined
    message: Schema Array Properties Have Min Items
    severity: info
    given: '$.properties[?(@.type=="array")]'
    then:
      - field: minItems
        function: falsy
    tags:
      - Security
      - Risk          
  json-schema-2020-12-properties-define-number-maximum-error:
    description: >-
      Schema properties that are of the type number should have a maximum
      property defined
    message: Schema Number Properties MUST Have Maximum
    severity: error
    given: '$.properties[?(@.type=="number")]'
    then:
      - field: maximum
        function: defined
    tags:
      - Security
      - Risk          
  json-schema-2020-12-properties-define-number-minimum-error:
    description: >-
      Schema properties that are of the type number should have a minimum
      property defined
    message: Schema Number Properties MUST Have Minimum
    severity: error
    given: '$.properties[?(@.type=="number")]'
    then:
      - field: minimum
        function: defined
    tags:
      - Security
      - Risk          
  json-schema-2020-12-properties-descriptions-error:
    description: >-
      Schema properties should have descriptions that provide a narrative of the
      property contains, and how it can be used
    message: Schema Properties MUST Have Description
    severity: error
    given: '$.properties[?(@.type == ''string'')]'
    then:
      field: description
      function: truthy
    tags:
      - Discovery
      - Documentation        
  json-schema-2020-12-properties-descriptions-info:
    description: >-
      Schema properties should have descriptions that provide a narrative of the
      property contains, and how it can be used
    message: Schema Properties Have Description
    severity: info
    given: '$.properties[?(@.type == ''string'')]'
    then:
      field: description
      function: falsy
    tags:
      - Discovery
      - Documentation  
  json-schema-2020-12-properties-descriptions-length-error:
    description: >-
      Schema property descriptions should have a length limit applied, applying
      constraints to writing descriptions, and keeping consistent across APIs
    message: Schema Properties Description MUST Have 250 Characters
    severity: error
    given: '$.properties[?(@.type == ''string'')]'
    then:
      field: description
      function: length
      functionOptions:
        max: 250
    tags:
      - Discovery
      - Documentation          
  json-schema-2020-12-properties-enum-casing-error:
    description: >-
      Schema property enumerators are consistent casing, keeping all entries
      upper snake case, and consistent across all APIs
    message: Schema Property Enum MUST Be Upper Snake Case
    severity: error
    given: $.properties.*.enum.*
    then:
      function: pattern
      functionOptions:
        match: '^[A-Z]+(?:_[A-Z]+)*$'
    tags:
      - Discovery
      - Documentation    
      - Security
      - Reliability      
  json-schema-2020-12-properties-enum-casing-info:
    description: >-
      Schema property enumerators are consistent casing, keeping all entries
      upper snake case, and consistent across all APIs
    message: Schema Property Enum Are Upper Snake Case
    severity: error
    given: $.properties.*.enum.*
    then:
      function: pattern
      functionOptions:
        notMatch: '^[A-Z]+(?:_[A-Z]+)*$'
    tags:
      - Discovery
      - Documentation    
      - Security
      - Reliability          
  json-schema-2020-12-properties-enum-info:
    description: >-
      Schema property has enumerators, providing consistent values chosen by
      consumers when making requests
    message: Schema Property Have Enum
    severity: info
    given: $.properties.*
    then:
      - field: enum
        function: falsy
    tags:
      - Discovery
      - Documentation    
      - Security
      - Reliability          
  json-schema-2020-12-properties-error:
    description: >-
      Schema has properties, providing more detail regarding the structure of
      each schema being applied as part of a request or a response
    message: Schema MUST Have Properties
    severity: error
    given: '$[?(@.type=="object")]'
    then:
      field: properties
      function: truthy
    tags:
      - Discovery
      - Documentation           
  json-schema-2020-12-properties-info:
    description: >-
      Schema has properties, providing more detail regarding the structure of
      each schema being applied as part of a request or a response
    message: Schema Have Properties
    severity: info
    given: '$[?(@.type=="object")]'
    then:
      field: properties
      function: falsy
    tags:
      - Discovery
      - Documentation         
  json-schema-2020-12-properties-names-camel-case-error:
    description: >-
      Schema property names are camel case, providing consistent casing across
      all the schema properties used by APIs
    message: Schema Property Names MUST Be camelCase.
    severity: error
    given: $properties
    then:
      - field: '@key'
        function: pattern
        functionOptions:
          notMatch: '^[A-Z][a-z0-9]*[A-Z0-9][a-z0-9]+[A-Za-z0-9]*$'
    tags:
      - Discovery
      - Documentation 
      - Reliability            
  json-schema-2020-12-properties-names-camel-case-info:
    description: >-
      Schema property names are camel case, providing consistent casing across
      all the schema properties used by APIs
    message: Schema Property Names Are camelCase.
    severity: info
    given: $properties
    then:
      - field: '@key'
        function: pattern
        functionOptions:
          match: '^[A-Z][a-z0-9]*[A-Z0-9][a-z0-9]+[A-Za-z0-9]*$'
    tags:
      - Discovery
      - Documentation 
      - Reliability            
  json-schema-2020-12-properties-names-length-error:
    description: >-
      Schema property names have a length restriction applied, keeping names
      consistent, and avoiding being too long
    message: Schema Properties Name Length
    severity: error
    given: $properties
    then:
      field: '@key'
      function: length
      functionOptions:
        max: 25
    tags:
      - Discovery
      - Documentation       
  json-schema-2020-12-properties-string-maxlength-error:
    description: >-
      Schema properties that are of the string type have the max length applied
      defining the shape of the property
    message: Schema String Properties MUST Have Maximum Length
    severity: error
    given: '$properties[?(@.type == ''string'')]'
    then:
      field: maxLength
      function: truthy
    tags:
      - Discovery
      - Documentation         
  json-schema-2020-12-properties-string-maxlength-info:
    description: >-
      Schema properties that are of the string type have the max length applied
      defining the shape of the property
    message: Schema String Properties Has Maximum Length
    severity: info
    given: '$properties[?(@.type == ''string'')]'
    then:
      field: maxLength
      function: falsy
    tags:
      - Security
      - Risk
      - Reliability         
  json-schema-2020-12-properties-string-minlength-error:
    description: >-
      Schema properties that are of the string type have the min length applied
      defining the shape of the property
    message: Schema String Properties MUST Have Minimum Length
    severity: error
    given: '$properties[?(@.type == ''string'')]'
    then:
      field: minLength
      function: truthy
    tags:
      - Security
      - Risk
      - Reliability         
  json-schema-2020-12-properties-string-minlength-info:
    description: >-
      Schema properties that are of the string type have the min length applied
      defining the shape of the property
    message: Schema String Properties Has Minimum Length
    severity: info
    given: '$properties[?(@.type == ''string'')]'
    then:
      field: minLength
      function: falsy
    tags:
      - Security
      - Risk
      - Reliability         
  json-schema-2020-12-required-error:
    description: >-
      All JSON Schema objects should explicitly define their properties and
      include at least one required property. Defining required properties
      enhances the accuracy and reliability of validation for each object.
    given: $
    severity: error
    then:
      field: name
      function: truthy
    tags:
      - Security
      - Risk
      - Reliability         
  json-schema-2020-12-required-info:
    description: >-
      All JSON Schema objects should explicitly define their properties and
      include at least one required property. Defining required properties
      enhances the accuracy and reliability of validation for each object.
    given: $
    severity: error
    then:
      field: name
      function: truthy
    tags:
      - Security
      - Risk
      - Reliability         
  json-schema-2020-12-schema-draft-error:
    description: >-
      The $schema property in a JSON Schema MUST always reference the latest
      draft of the specification to ensure consistent validation across all
      objects. Using the most up-to-date version of the specification helps
      maintain stability and reliability in the use of objects within any API.
    given: $
    severity: error
    then:
      field: $schema
      function: pattern
      functionOptions:
        match: 'https://json-schema.org/draft/2020-12/schema'
    tags:
      - Changes          
  json-schema-2020-12-schema-draft-info:
    description: >-
      The $schema property in a JSON Schema MUST always reference the latest
      draft of the specification to ensure consistent validation across all
      objects. Using the most up-to-date version of the specification helps
      maintain stability and reliability in the use of objects within any API.
    given: $
    severity: error
    then:
      field: $schema
      function: pattern
      functionOptions:
        notMatch: 'https://json-schema.org/draft/2020-12/schema'
    tags:
      - Changes            
  json-schema-2020-12-schema-error:
    description: >-
      JSON Schema objects should always include the $schema property to
      explicitly indicate which version of the specification is being used. This
      property is essential for tooling and should consistently reference the
      latest version to ensure compatibility and up-to-date functionality.
    given: $
    severity: error
    then:
      field: $schema
      function: truthy
    tags:
      - Changes          
  json-schema-2020-12-schema-info:
    description: >-
      JSON Schema objects should always include the $schema property to
      explicitly indicate which version of the specification is being used. This
      property is essential for tooling and should consistently reference the
      latest version to ensure compatibility and up-to-date functionality.
    given: $
    severity: error
    then:
      field: $schema
      function: falsy
    tags:
      - Changes          
  json-schema-2020-12-title-error:
    description: >-
      JSON Schema objects MUST include a title property that describes the
      object in plain language while reflecting the object's file name. The
      title should convey the object's content and purpose, providing clarity on
      how it is intended to be used.
    given: $
    severity: error
    then:
      field: title
      function: truthy
    tags:
      - Discovery
      - Documentation          
  json-schema-2020-12-title-info:
    description: >-
      JSON Schema objects MUST include a title property that describes the
      object in plain language while reflecting the object's file name. The
      title should convey the object's content and purpose, providing clarity on
      how it is intended to be used.
    given: $
    severity: error
    then:
      field: title
      function: falsy
    tags:
      - Discovery
      - Documentation         
  json-schema-2020-12-title-pascal-case-error:
    description: >-
      The name of a JSON Schema object should always be in PascalCase to ensure
      readability and consistency across APIs. Using PascalCase helps maintain
      uniformity and aligns the object's name with its plain-language title.
    given: $
    severity: error
    then:
      - field: title
        function: pattern
        functionOptions:
          match: '^[A-Z](([a-z]+[A-Z]?)*)$'
      - field: title
        function: pattern
        functionOptions:
          match: '^[A-Z](([a-z0-9]+[A-Z]?)*)$'
    tags:
      - Discovery
      - Documentation   
      - Reliability          
  json-schema-2020-12-title-pascal-case-info:
    description: >-
      The name of a JSON Schema object should always be in PascalCase to ensure
      readability and consistency across APIs. Using PascalCase helps maintain
      uniformity and aligns the object's name with its plain-language title.
    given: $
    severity: error
    then:
      - field: title
        function: pattern
        functionOptions:
          notMatch: '^[A-Z](([a-z]+[A-Z]?)*)$'
      - field: title
        function: pattern
        functionOptions:
          notMatch: '^[A-Z](([a-z0-9]+[A-Z]?)*)$'
    tags:
      - Discovery
      - Documentation   
      - Reliability            
  json-schema-2020-12-type-error:
    description: >-
      JSON Schema objects should explicitly define their type, ensuring clarity
      about each object's structure. This allows tools utilizing the schema to
      accurately validate the object wherever it is applied.
    given: $
    severity: error
    then:
      field: type
      function: truthy
    tags:
      - Reliability        
  json-schema-2020-12-type-info:
    description: >-
      JSON Schema objects should explicitly define their type, ensuring clarity
      about each object's structure. This allows tools utilizing the schema to
      accurately validate the object wherever it is applied.
    given: $
    severity: error
    then:
      field: type
      function: falsy
    tags:
      - Reliability           
